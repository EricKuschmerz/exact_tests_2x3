my_matrix <- matrix(ncol=3, byrow=TRUE)

my_matrix <- my_matrix[-1, , drop=FALSE]



m <- 8
n <- 7
u <- 6

alpha <- 0.05

p <- seq(0.001, 0.500, by=0.001)



kandidatenmenge1 <- matrix(ncol=3, , byrow=TRUE)
kandidatenmenge1 <- kandidatenmenge1[-1, , drop=FALSE]

kandidatenmenge2 <- matrix(ncol=3, , byrow=TRUE)
kandidatenmenge2 <- kandidatenmenge2[-1, , drop=FALSE]

kandidatenmenge3 <- matrix(ncol=3, , byrow=TRUE)
kandidatenmenge3 <- kandidatenmenge3[-1, , drop=FALSE]

n_p1 <- c(m,0,0)
n_p2 <- c(0,n,0)
n_p3 <- c(0,0,u)

kandidatenmenge1 <- rbind(kandidatenmenge1, n_p1)
kandidatenmenge2 <- rbind(kandidatenmenge2, n_p2)
kandidatenmenge3 <- rbind(kandidatenmenge3, n_p3)






         
result <- function()
{
i <- 1
while(nrow(my_matrix) < m*n*u)
{
lst1 <- c()
for (k in 1:nrow(kandidatenmenge1)) {
                                    P_k_max <- function() {sum <- 0
                                                          sumI <- 0
                                                          if (nrow(my_matrix) == 0) {
                                                                                    sum <- 0
                                                                                    }
                                                          if (nrow(my_matrix) != 0) {
                                                                                    for (j in 1:nrow(my_matrix)) {                                                                                                
                                                                                                                 termI <- (factorial(m) * factorial(n) * factorial(u) / (factorial(my_matrix[j,1]) * factorial(my_matrix[j,2]) * factorial(my_matrix[j,3]) * factorial(m-my_matrix[j,1]) * factorial(n-my_matrix[j,2]) * factorial(u-my_matrix[j,3]))) * (p^(my_matrix[j,1]+my_matrix[j,2]+my_matrix[j,3]) * (1-p)^(m-my_matrix[j,1]+ (n-my_matrix[j,2]) + (u-my_matrix[j,3])))  
                                                                                                                 sum <- sum + termI
                                                                                                                 }
                                                                                    }                                                                                                                                                 
                                                          TermII <- sum + (factorial(m) * factorial(n) * factorial(u) / (factorial(kandidatenmenge1[k,1]) * factorial(kandidatenmenge1[k,2]) * factorial(kandidatenmenge1[k,3]) * factorial(m-kandidatenmenge1[k,1]) * factorial(n-kandidatenmenge1[k,2]) * factorial(u-kandidatenmenge1[k,3]))) * (p^(kandidatenmenge1[k,1]+kandidatenmenge1[k,2]+kandidatenmenge1[k,3]) * (1-p)^(m-kandidatenmenge1[k,1]+ (n-kandidatenmenge1[k,2]) + (u-kandidatenmenge1[k,3])) + (1-p)^(kandidatenmenge1[k,1]+kandidatenmenge1[k,2]+kandidatenmenge1[k,3]) * p^(m-kandidatenmenge1[k,1]+ (n-kandidatenmenge1[k,2]) + (u-kandidatenmenge1[k,3])))
                                                          p_k_max <- p[which.max(TermII)]
                                                          if (nrow(my_matrix) == 0) {
                                                                                    sumI <- 0
                                                                                    }
                                                          if (nrow(my_matrix) != 0) {
                                                                                    for (j in 1:nrow(my_matrix)) {
                                                                                                                 TermI <- (factorial(m) * factorial(n) * factorial(u) / (factorial(my_matrix[j,1]) * factorial(my_matrix[j,2]) * factorial(my_matrix[j,3]) * factorial(m-my_matrix[j,1]) * factorial(n-my_matrix[j,2]) * factorial(u-my_matrix[j,3]))) * (p_k_max^(my_matrix[j,1]+my_matrix[j,2]+my_matrix[j,3]) * (1-p_k_max)^(m-my_matrix[j,1]+ (n-my_matrix[j,2]) + (u-my_matrix[j,3])))
                                                                                                                 sumI <- sumI + TermI                                                                     
                                                                                                                 } 
                                                                                    }                                                                                                                                                                                                                                                                                                      
                                                          TermIII <- sumI + (factorial(m) * factorial(n) * factorial(u) / (factorial(kandidatenmenge1[k,1]) * factorial(kandidatenmenge1[k,2]) * factorial(kandidatenmenge1[k,3]) * factorial(m-kandidatenmenge1[k,1]) * factorial(n-kandidatenmenge1[k,2]) * factorial(u-kandidatenmenge1[k,3]))) * (p_k_max^(kandidatenmenge1[k,1]+kandidatenmenge1[k,2]+kandidatenmenge1[k,3]) * (1-p_k_max)^(m-kandidatenmenge1[k,1]+ (n-kandidatenmenge1[k,2]) + (u-kandidatenmenge1[k,3])) + (1-p_k_max)^(kandidatenmenge1[k,1]+kandidatenmenge1[k,2]+kandidatenmenge1[k,3]) * p_k_max^(m-kandidatenmenge1[k,1]+ (n-kandidatenmenge1[k,2]) + (u-kandidatenmenge1[k,3])))
                                                          return(TermIII)
                                                          }
                                     ErgebnisIII <- P_k_max()
                                     lst1 <- c(lst1,ErgebnisIII)
                                     } 
              
min_indizes1 <- function(lst1) { 
                               which(lst1 == min(lst1)) 
                               }




lst2 <- c()
for (k in 1:nrow(kandidatenmenge2)) {
                                    P_k_max <- function() {sum <- 0
                                                          sumI <- 0
                                                          if (nrow(my_matrix) == 0) {
                                                                                    sum <- 0
                                                                                    }
                                                          if (nrow(my_matrix) != 0) {
                                                                                    for (j in 1:nrow(my_matrix)) {                                                                                                
                                                                                                                 termI <- (factorial(m) * factorial(n) * factorial(u) / (factorial(my_matrix[j,1]) * factorial(my_matrix[j,2]) * factorial(my_matrix[j,3]) * factorial(m-my_matrix[j,1]) * factorial(n-my_matrix[j,2]) * factorial(u-my_matrix[j,3]))) * (p^(my_matrix[j,1]+my_matrix[j,2]+my_matrix[j,3]) * (1-p)^(m-my_matrix[j,1]+ (n-my_matrix[j,2]) + (u-my_matrix[j,3])))  
                                                                                                                 sum <- sum + termI
                                                                                                                 }
                                                                                    }                                                                                                                                                 
                                                          TermII <- sum + (factorial(m) * factorial(n) * factorial(u) / (factorial(kandidatenmenge2[k,1]) * factorial(kandidatenmenge2[k,2]) * factorial(kandidatenmenge2[k,3]) * factorial(m-kandidatenmenge2[k,1]) * factorial(n-kandidatenmenge2[k,2]) * factorial(u-kandidatenmenge2[k,3]))) * (p^(kandidatenmenge2[k,1]+kandidatenmenge2[k,2]+kandidatenmenge2[k,3]) * (1-p)^(m-kandidatenmenge2[k,1]+ (n-kandidatenmenge2[k,2]) + (u-kandidatenmenge2[k,3])) + (1-p)^(kandidatenmenge2[k,1]+kandidatenmenge2[k,2]+kandidatenmenge2[k,3]) * p^(m-kandidatenmenge2[k,1]+ (n-kandidatenmenge2[k,2]) + (u-kandidatenmenge2[k,3])))
                                                          p_k_max <- p[which.max(TermII)]
                                                          if (nrow(my_matrix) == 0) {
                                                                                    sumI <- 0
                                                                                    }
                                                          if (nrow(my_matrix) != 0) {
                                                                                    for (j in 1:nrow(my_matrix)) {
                                                                                                                 TermI <- (factorial(m) * factorial(n) * factorial(u) / (factorial(my_matrix[j,1]) * factorial(my_matrix[j,2]) * factorial(my_matrix[j,3]) * factorial(m-my_matrix[j,1]) * factorial(n-my_matrix[j,2]) * factorial(u-my_matrix[j,3]))) * (p_k_max^(my_matrix[j,1]+my_matrix[j,2]+my_matrix[j,3]) * (1-p_k_max)^(m-my_matrix[j,1]+ (n-my_matrix[j,2]) + (u-my_matrix[j,3])))
                                                                                                                 sumI <- sumI + TermI                                                                     
                                                                                                                 } 
                                                                                    }                                                                                                                                                                                                                                                                                                      
                                                          TermIII <- sumI + (factorial(m) * factorial(n) * factorial(u) / (factorial(kandidatenmenge2[k,1]) * factorial(kandidatenmenge2[k,2]) * factorial(kandidatenmenge2[k,3]) * factorial(m-kandidatenmenge2[k,1]) * factorial(n-kandidatenmenge2[k,2]) * factorial(u-kandidatenmenge2[k,3]))) * (p_k_max^(kandidatenmenge2[k,1]+kandidatenmenge2[k,2]+kandidatenmenge2[k,3]) * (1-p_k_max)^(m-kandidatenmenge2[k,1]+ (n-kandidatenmenge2[k,2]) + (u-kandidatenmenge2[k,3])) + (1-p_k_max)^(kandidatenmenge2[k,1]+kandidatenmenge2[k,2]+kandidatenmenge2[k,3]) * p_k_max^(m-kandidatenmenge2[k,1]+ (n-kandidatenmenge2[k,2]) + (u-kandidatenmenge2[k,3])))
                                                          return(TermIII)
                                                          }
                                     ErgebnisIII <- P_k_max()
                                     lst2 <- c(lst2,ErgebnisIII)
                                     } 
              
min_indizes2 <- function(lst2) { 
                               which(lst2 == min(lst2)) 
                               }






lst3 <- c()
for (k in 1:nrow(kandidatenmenge3)) {
                                    P_k_max <- function() {sum <- 0
                                                          sumI <- 0
                                                          if (nrow(my_matrix) == 0) {
                                                                                    sum <- 0
                                                                                    }
                                                          if (nrow(my_matrix) != 0) {
                                                                                    for (j in 1:nrow(my_matrix)) {                                                                                                
                                                                                                                 termI <- (factorial(m) * factorial(n) * factorial(u) / (factorial(my_matrix[j,1]) * factorial(my_matrix[j,2]) * factorial(my_matrix[j,3]) * factorial(m-my_matrix[j,1]) * factorial(n-my_matrix[j,2]) * factorial(u-my_matrix[j,3]))) * (p^(my_matrix[j,1]+my_matrix[j,2]+my_matrix[j,3]) * (1-p)^(m-my_matrix[j,1]+ (n-my_matrix[j,2]) + (u-my_matrix[j,3])))  
                                                                                                                 sum <- sum + termI
                                                                                                                 }
                                                                                    }                                                                                                                                                 
                                                          TermII <- sum + (factorial(m) * factorial(n) * factorial(u) / (factorial(kandidatenmenge3[k,1]) * factorial(kandidatenmenge3[k,2]) * factorial(kandidatenmenge3[k,3]) * factorial(m-kandidatenmenge3[k,1]) * factorial(n-kandidatenmenge3[k,2]) * factorial(u-kandidatenmenge3[k,3]))) * (p^(kandidatenmenge3[k,1]+kandidatenmenge3[k,2]+kandidatenmenge3[k,3]) * (1-p)^(m-kandidatenmenge3[k,1]+ (n-kandidatenmenge3[k,2]) + (u-kandidatenmenge3[k,3])) + p^(m-kandidatenmenge3[k,1]+ (n-kandidatenmenge3[k,2]) + (u-kandidatenmenge3[k,3])) * (1-p)^(kandidatenmenge3[k,1]+kandidatenmenge3[k,2]+kandidatenmenge3[k,3]))
                                                          p_k_max <- p[which.max(TermII)]
                                                          if (nrow(my_matrix) == 0) {
                                                                                    sumI <- 0
                                                                                    }
                                                          if (nrow(my_matrix) != 0) {
                                                                                    for (j in 1:nrow(my_matrix)) {
                                                                                                                 TermI <- (factorial(m) * factorial(n) * factorial(u) / (factorial(my_matrix[j,1]) * factorial(my_matrix[j,2]) * factorial(my_matrix[j,3]) * factorial(m-my_matrix[j,1]) * factorial(n-my_matrix[j,2]) * factorial(u-my_matrix[j,3]))) * (p_k_max^(my_matrix[j,1]+my_matrix[j,2]+my_matrix[j,3]) * (1-p_k_max)^(m-my_matrix[j,1]+ (n-my_matrix[j,2]) + (u-my_matrix[j,3])))
                                                                                                                 sumI <- sumI + TermI                                                                     
                                                                                                                 } 
                                                                                    }                                                                                                                                                                                                                                                                                                      
                                                          TermIII <- sumI + (factorial(m) * factorial(n) * factorial(u) / (factorial(kandidatenmenge3[k,1]) * factorial(kandidatenmenge3[k,2]) * factorial(kandidatenmenge3[k,3]) * factorial(m-kandidatenmenge3[k,1]) * factorial(n-kandidatenmenge3[k,2]) * factorial(u-kandidatenmenge3[k,3]))) * (p_k_max^(kandidatenmenge3[k,1]+kandidatenmenge3[k,2]+kandidatenmenge3[k,3]) * (1-p_k_max)^(m-kandidatenmenge3[k,1]+ (n-kandidatenmenge3[k,2]) + (u-kandidatenmenge3[k,3])) + p_k_max^(m-kandidatenmenge3[k,1]+ (n-kandidatenmenge3[k,2]) + (u-kandidatenmenge3[k,3])) * (1-p_k_max)^(kandidatenmenge3[k,1]+kandidatenmenge3[k,2]+kandidatenmenge3[k,3]))
                                                          return(TermIII)
                                                          }
                                     ErgebnisIII <- P_k_max()
                                     lst3 <- c(lst3,ErgebnisIII)
                                     } 
              
min_indizes3 <- function(lst3) { 
                               which(lst3 == min(lst3)) 
                               }




zwischenmatrix <- matrix(ncol=3, ,byrow=TRUE)
zwischenmatrix <- zwischenmatrix[-1, , drop=FALSE]

if (min(lst1) <= min(lst2) && min(lst1) <= min(lst3)) { 
                                                    for (e in 1:length(min_indizes1(lst1))) {
                                                                                            N_p <- c(kandidatenmenge1[min_indizes1(lst1)[e],1],kandidatenmenge1[min_indizes1(lst1)[e],2],kandidatenmenge1[min_indizes1(lst1)[e],3])
                                                                                            N_p1 <- c(m - kandidatenmenge1[min_indizes1(lst1)[e],1],n - kandidatenmenge1[min_indizes1(lst1)[e],2],u - kandidatenmenge1[min_indizes1(lst1)[e],3])
                                                                                            zwischenmatrix <- rbind(zwischenmatrix, N_p)
                                                                                            zwischenmatrix <- rbind(zwischenmatrix, N_p1)
                                                                                            }
                                                    }
                                                    
if (min(lst2) <= min(lst1) && min(lst2) <= min(lst3)) { 
                                                    for (e in 1:length(min_indizes2(lst2))) {
                                                                                            N_p <- c(kandidatenmenge2[min_indizes2(lst2)[e],1],kandidatenmenge2[min_indizes2(lst2)[e],2],kandidatenmenge2[min_indizes2(lst2)[e],3])
                                                                                            N_p1 <- c(m - kandidatenmenge2[min_indizes2(lst2)[e],1],n - kandidatenmenge2[min_indizes2(lst2)[e],2],u - kandidatenmenge2[min_indizes2(lst2)[e],3])
                                                                                            zwischenmatrix <- rbind(zwischenmatrix, N_p)
                                                                                            zwischenmatrix <- rbind(zwischenmatrix, N_p1)
                                                                                            }
                                                    }
if (min(lst3) <= min(lst1) && min(lst3) <= min(lst2)) { 
                                                    for (e in 1:length(min_indizes3(lst3))) {
                                                                                            N_p <- c(kandidatenmenge3[min_indizes3(lst3)[e],1],kandidatenmenge3[min_indizes3(lst3)[e],2],kandidatenmenge3[min_indizes3(lst3)[e],3])
                                                                                            N_p1 <- c(m - kandidatenmenge3[min_indizes3(lst3)[e],1],n - kandidatenmenge3[min_indizes3(lst3)[e],2],u - kandidatenmenge3[min_indizes3(lst3)[e],3])
                                                                                            zwischenmatrix <- rbind(zwischenmatrix, N_p)
                                                                                            zwischenmatrix <- rbind(zwischenmatrix, N_p1)
                                                                                            }
                                                    }


e <- nrow(zwischenmatrix)

zwischenmatrix <- unique(zwischenmatrix)

o <- nrow(zwischenmatrix)


if (nrow(zwischenmatrix) == 2 && e == o) {
                                         if (min(lst1) < min(lst2) && min(lst1) < min(lst3)) {
                                                                                             p_value <- min(lst1)                                                                                                     
                                                                                             } 
                                         if (min(lst2) < min(lst1) && min(lst2) < min(lst3)) {
                                                                                             p_value <- min(lst2)                                                                                                     
                                                                                             }
                                         if (min(lst3) < min(lst1) && min(lst3) < min(lst2)) {
                                                                                             p_value <- min(lst3)                                                                                                                                                                                                 
                                                                                             } 
                                                                                              
                                         }                                                                                                   




                                                                                     




if (nrow(zwischenmatrix) > 2 || e != o) {
                                        pv <- function() {
                                                    sumIII <- 0
                                                    sumIV <- 0                                                                                                                                                                                                                                                                                                                                               
                                                   if (nrow(my_matrix) != 0) {
                                                                             for (j in 1:nrow(my_matrix)) {                                                                                                
                                                                                                          neues_paar <- c(my_matrix[j,1],my_matrix[j,2],my_matrix[j,3])
                                                                                                          zwischenmatrix <- rbind(zwischenmatrix,neues_paar)
                                                                                                          }
                                                                             }
                                                                                                                                                                                                                         
                                                   for (k in 1:nrow(zwischenmatrix)) {
                                                                                     TermI <- (factorial(m) * factorial(n) * factorial(u) / (factorial(zwischenmatrix[k,1]) * factorial(zwischenmatrix[k,2]) * factorial(zwischenmatrix[k,3]) * factorial(m-zwischenmatrix[k,1]) * factorial(n-zwischenmatrix[k,2]) * factorial(u-zwischenmatrix[k,3]))) * (p^(zwischenmatrix[k,1]+zwischenmatrix[k,2]+zwischenmatrix[k,3]) * (1-p)^(m-zwischenmatrix[k,1]+ (n-zwischenmatrix[k,2]) + (u-zwischenmatrix[k,3]))) 
                                                                                     sumIII <- sumIII + TermI
                                                                                     }                                                                                    
                                                   p_max <- p[which.max(sumIII)]
                                                   for (k in 1:nrow(zwischenmatrix)) {
                                                                                     TermII <- (factorial(m) * factorial(n) * factorial(u) / (factorial(zwischenmatrix[k,1]) * factorial(zwischenmatrix[k,2]) * factorial(zwischenmatrix[k,3]) * factorial(m-zwischenmatrix[k,1]) * factorial(n-zwischenmatrix[k,2]) * factorial(u-zwischenmatrix[k,3]))) * (p_max^(zwischenmatrix[k,1]+zwischenmatrix[k,2]+zwischenmatrix[k,3]) * (1-p_max)^(m-zwischenmatrix[k,1]+ (n-zwischenmatrix[k,2]) + (u-zwischenmatrix[k,3])))
                                                                                     sumIV <- sumIV + TermII
                                                                                     }
                                                                               
                                                   return(sumIV)                                                                    
                                                   }
                                   p_value <- pv()
                                    
                                  }


 
                                                                                                                                   
                                                                                                         
if (p_value > alpha) {
                     break
                     } 


     
for (s in 1:o) {
               neues_paar <- c(zwischenmatrix[s,1],zwischenmatrix[s,2],zwischenmatrix[s,3])               
               my_matrix <- rbind(my_matrix,neues_paar)               
               }
                                  

 
if (min(lst1) <= min(lst2) && min(lst1) <= min(lst3)) {                                                      
                                                      for (e in 1:length(min_indizes1(lst1))) {                                                                                          
                                                                                              N_P <- c(kandidatenmenge1[min_indizes1(lst1)[e],1]-1,kandidatenmenge1[min_indizes1(lst1)[e],2],kandidatenmenge1[min_indizes1(lst1)[e],3])
                                                                                              N_P1 <- c(kandidatenmenge1[min_indizes1(lst1)[e],1],kandidatenmenge1[min_indizes1(lst1)[e],2]+1,kandidatenmenge1[min_indizes1(lst1)[e],3])
                                                                                              N_P2 <- c(kandidatenmenge1[min_indizes1(lst1)[e],1],kandidatenmenge1[min_indizes1(lst1)[e],2],kandidatenmenge1[min_indizes1(lst1)[e],3]+1)
                                                                                              kandidatenmenge1 <- rbind(kandidatenmenge1, N_P)
                                                                                              kandidatenmenge1 <- rbind(kandidatenmenge1, N_P1)
                                                                                              kandidatenmenge1 <- rbind(kandidatenmenge1, N_P2)
                                                                                              }
                                                      }
                                                                                             
                                                       

if (min(lst2) <= min(lst1) && min(lst2) <= min(lst3)) {                                                      
                                                      for (e in 1:length(min_indizes2(lst2))) {                                                                                          
                                                                                              N_P <- c(kandidatenmenge2[min_indizes2(lst2)[e],1],kandidatenmenge2[min_indizes1(lst2)[e],2]-1,kandidatenmenge2[min_indizes2(lst2)[e],3])
                                                                                              N_P1 <- c(kandidatenmenge2[min_indizes2(lst2)[e],1]+1,kandidatenmenge2[min_indizes1(lst2)[e],2],kandidatenmenge2[min_indizes2(lst2)[e],3])
                                                                                              N_P2 <- c(kandidatenmenge2[min_indizes2(lst2)[e],1],kandidatenmenge2[min_indizes1(lst2)[e],2],kandidatenmenge2[min_indizes2(lst2)[e],3]+1)                                      
                                                                                              kandidatenmenge2 <- rbind(kandidatenmenge2, N_P)
                                                                                              kandidatenmenge2 <- rbind(kandidatenmenge2, N_P1)
                                                                                              kandidatenmenge2 <- rbind(kandidatenmenge2, N_P2)
                                                                                              }
                                                      }

if (min(lst3) <= min(lst1) && min(lst3) <= min(lst2)) {                                                      
                                                      for (e in 1:length(min_indizes3(lst3))) {                                                                                          
                                                                                              N_P <- c(kandidatenmenge3[min_indizes3(lst3)[e],1],kandidatenmenge3[min_indizes3(lst3)[e],2],kandidatenmenge3[min_indizes3(lst3)[e],3]-1)
                                                                                              N_P1 <- c(kandidatenmenge3[min_indizes3(lst3)[e],1]+1,kandidatenmenge3[min_indizes3(lst3)[e],2],kandidatenmenge3[min_indizes3(lst3)[e],3])
                                                                                              N_P2 <- c(kandidatenmenge3[min_indizes3(lst3)[e],1],kandidatenmenge3[min_indizes3(lst3)[e],2]+1,kandidatenmenge3[min_indizes3(lst3)[e],3])                                                                                             
                                                                                              kandidatenmenge3 <- rbind(kandidatenmenge3, N_P)
                                                                                              kandidatenmenge3 <- rbind(kandidatenmenge3, N_P1)
                                                                                              kandidatenmenge3 <- rbind(kandidatenmenge3, N_P2)
                                                                                              }
                                                      }


                                                     





kandidatenmengeI <- matrix(ncol=3, , byrow=TRUE)
kandidatenmengeI <- kandidatenmengeI[-1, , drop=FALSE]
for (g in 1:nrow(kandidatenmenge1)) {T <- 0
                                    for (f in 1:nrow(my_matrix)) {                                                                
                                                                 if (my_matrix[f,1]==kandidatenmenge1[g,1] && my_matrix[f,2]==kandidatenmenge1[g,2] && my_matrix[f,3]==kandidatenmenge1[g,3]) {
                                                                                                                                                                                             t <- 1 
                                                                 T <- T + t                                                                                                                  }
                                                                 }                                                                                                                           
                                    if (T==0) {
                                              N_p <- c(kandidatenmenge1[g,1],kandidatenmenge1[g,2],kandidatenmenge1[g,3])
                                              kandidatenmengeI <- rbind(kandidatenmengeI,N_p)
                                              }
                                                                
                                    }
kandidatenmenge1 <- kandidatenmengeI



kandidatenmengeII <- matrix(ncol=3, , byrow=TRUE)
kandidatenmengeII <- kandidatenmengeII[-1, , drop=FALSE]
for (g in 1:nrow(kandidatenmenge2)) {T <- 0
                                    for (f in 1:nrow(my_matrix)) {                                                                
                                                                 if (my_matrix[f,1]==kandidatenmenge2[g,1] && my_matrix[f,2]==kandidatenmenge2[g,2] && my_matrix[f,3]==kandidatenmenge2[g,3]) {
                                                                                                                                                                                             t <- 1 
                                                                 T <- T + t                                                                                                                  }
                                                                 }                                                                                                                           
                                    if (T==0) {
                                              N_p <- c(kandidatenmenge2[g,1],kandidatenmenge2[g,2],kandidatenmenge2[g,3])
                                              kandidatenmengeII <- rbind(kandidatenmengeII,N_p)
                                              }
                                                                
                                    }
kandidatenmenge2 <- kandidatenmengeII



kandidatenmengeIII <- matrix(ncol=3, , byrow=TRUE)
kandidatenmengeIII <- kandidatenmengeIII[-1, , drop=FALSE]
for (g in 1:nrow(kandidatenmenge3)) {T <- 0
                                    for (f in 1:nrow(my_matrix)) {                                                                
                                                                 if (my_matrix[f,1]==kandidatenmenge3[g,1] && my_matrix[f,2]==kandidatenmenge3[g,2] && my_matrix[f,3]==kandidatenmenge3[g,3]) {
                                                                                                                                                                                             t <- 1 
                                                                 T <- T + t                                                                                                                  }
                                                                 }                                                                                                                           
                                    if (T==0) {
                                              N_p <- c(kandidatenmenge3[g,1],kandidatenmenge3[g,2],kandidatenmenge3[g,3])
                                              kandidatenmengeIII <- rbind(kandidatenmengeIII,N_p)
                                              }
                                                                
                                    }
kandidatenmenge3 <- kandidatenmengeIII


  Kandidatenmenge1 <- matrix(ncol=3, , byrow=TRUE)
  Kandidatenmenge1 <- Kandidatenmenge1[-1, , drop=FALSE]
  Kandidatenmenge2 <- matrix(ncol=3, , byrow=TRUE)
  Kandidatenmenge2 <- Kandidatenmenge2[-1, , drop=FALSE]
  Kandidatenmenge3 <- matrix(ncol=3, , byrow=TRUE)
  Kandidatenmenge3 <- Kandidatenmenge3[-1, , drop=FALSE]
  for (k in 1:nrow(kandidatenmenge1)) {S <- 0
                                      for (j in 1:nrow(kandidatenmenge1)) {s <- 0
                                                                          if ((kandidatenmenge1[k,1] < kandidatenmenge1[j,1] && kandidatenmenge1[k,2] == kandidatenmenge1[j,2] && kandidatenmenge1[k,3] == kandidatenmenge1[j,3]) || (kandidatenmenge1[k,1] == kandidatenmenge1[j,1] && kandidatenmenge1[k,2] > kandidatenmenge1[j,2] && kandidatenmenge1[k,3] == kandidatenmenge1[j,3]) || (kandidatenmenge1[k,1] == kandidatenmenge1[j,1] && kandidatenmenge1[k,2] == kandidatenmenge1[j,2] && kandidatenmenge1[k,3] > kandidatenmenge1[j,3]))
                                                                                   {
                                                                                   s <- 1
                                                                                   }
                                                                          S <- S + s
                                                                          }
                                      if (S==0)   {
                                                  N_p <- c(kandidatenmenge1[k,1],kandidatenmenge1[k,2],kandidatenmenge1[k,3])
                                                  Kandidatenmenge1 <- rbind(Kandidatenmenge1, N_p)
                                                  }
                                      }
  kandidatenmenge1 <- Kandidatenmenge1
  for (k in 1:nrow(kandidatenmenge2)) {S <- 0
                                      for (j in 1:nrow(kandidatenmenge2)) {s <- 0
                                                                          if ((kandidatenmenge2[k,1] > kandidatenmenge2[j,1] && kandidatenmenge2[k,2] == kandidatenmenge2[j,2] && kandidatenmenge2[k,3] == kandidatenmenge2[j,3]) || (kandidatenmenge2[k,1] == kandidatenmenge2[j,1] && kandidatenmenge2[k,2] < kandidatenmenge2[j,2] && kandidatenmenge2[k,3] == kandidatenmenge2[j,3]) || (kandidatenmenge2[k,1] == kandidatenmenge2[j,1] && kandidatenmenge2[k,2] == kandidatenmenge2[j,2] && kandidatenmenge2[k,3] > kandidatenmenge2[j,3]))
                                                                                   {
                                                                                   s <- 1
                                                                                   }
                                                                           S <- S + s
                                                                          }
                                     if (S==0)   {
                                                 N_p <- c(kandidatenmenge2[k,1],kandidatenmenge2[k,2],kandidatenmenge2[k,3])
                                                 Kandidatenmenge2 <- rbind(Kandidatenmenge2, N_p)
                                                 }
                                      }
  kandidatenmenge2 <- Kandidatenmenge2
  for (k in 1:nrow(kandidatenmenge3)) {S <- 0
                                      for (j in 1:nrow(kandidatenmenge3)) {s <- 0
                                                                          if ((kandidatenmenge3[k,1] > kandidatenmenge3[j,1] && kandidatenmenge3[k,2] == kandidatenmenge3[j,2] && kandidatenmenge3[k,3] == kandidatenmenge3[j,3]) || (kandidatenmenge3[k,1] == kandidatenmenge3[j,1] && kandidatenmenge3[k,2] > kandidatenmenge3[j,2] && kandidatenmenge3[k,3] == kandidatenmenge3[j,3]) || (kandidatenmenge3[k,1] == kandidatenmenge3[j,1] && kandidatenmenge3[k,2] == kandidatenmenge3[j,2] && kandidatenmenge3[k,3] < kandidatenmenge3[j,3]))
                                                                                  {
                                                                                  s <- 1
                                                                                  }
                                                                          S <- S + s
                                                                          }
                                      if (S==0)   {
                                                  N_p <- c(kandidatenmenge3[k,1],kandidatenmenge3[k,2],kandidatenmenge3[k,3])
                                                  Kandidatenmenge3 <- rbind(Kandidatenmenge3, N_p)
                                                  }
                                      }

  kandidatenmenge3 <- Kandidatenmenge3  

 
                    
i <- i + 1

}
return(my_matrix)
}
ablehnregion <- result()
